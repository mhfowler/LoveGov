{% extends 'deployment/pages/login/login.html' %}

{% block middle %}

<div class="forgot-password forgot-password-left">
    <p style="font-size:21px">Enter your email here</p>
    <form action="" method="post"> {% csrf_token %}
        <table>
            <tr>
                <td>
                    <input type="text" id="email-recovery" class="login-input" name="email"/>
                </td>
            </tr>
            <tr>
                <td colspan=2>
                    <input type="hidden" name="button" value="first_step"/>
                    <input class="submit-button" id="first_step" type="submit" value="submit"/>
                    <p style="font-size:17px;float:left;margin-top:20px">
                        {{ error1 }}
                    </p>
                </td>
                <td></td>
            </tr>
        </table>
    </form>
</div>


<div class="forgot-password forgot-password-right">
    {% if second_step %}
        {% include 'deployment/pages/login/login-forgot-password-step_two.html' %}
    {% endif %}
</div>


<script type="text/javascript">
    $(document).ready(function()
    {
        $('#first_step').click(function(event)
        {
            event.preventDefault();
            $.ajax
            ({
                url:"/passwordRecovery/",
                type:"POST",
                data:{email:$('#email-recovery').val(),first_step:true},
                success: function(data)
                {
                    var returned = eval('(' + data + ')');
                    if (returned.error1) { $('#first_step').siblings('p').text(returned.error1); }
                    else
                    {
                        $('#first_step').siblings('p').empty();
                        $('.forgot-password-right').html(returned.html);
                    }

                },
                error: function(jqXHR, textStatus, errorThrown)
                {
                    $('#first_step').siblings('p').text("Server Error, Try Again.");
                }
            })
        });
    });

</script>

{% endblock %}